"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var lbwVue=function(){function t(e){_classCallCheck(this,t),this.$options=e,this.$data=e.data,this.observe(this.$data),new Compile(e.el,this),e.created&&e.created.call(this)}return _createClass(t,[{key:"observe",value:function(t){var n=this;t&&"object"===_typeof(t)&&Object.keys(t).forEach(function(e){n.defineReactive(t,e,t[e]),n.proxyData(e)})}},{key:"defineReactive",value:function(e,t,n){this.observe(n);var i=new Dep;Object.defineProperty(e,t,{get:function(){return Dep.target&&i.addDep(Dep.target),n},set:function(e){e!==n&&(n=e,i.notify())}})}},{key:"proxyData",value:function(t){Object.defineProperty(this,t,{get:function(){return this.$data[t]},set:function(e){this.$data[t]=e}})}}]),t}(),Dep=function(){function e(){_classCallCheck(this,e),this.deps=[]}return _createClass(e,[{key:"addDep",value:function(e){this.deps.push(e)}},{key:"notify",value:function(){this.deps.forEach(function(e){return e.update()})}}]),e}(),Watcher=function(){function i(e,t,n){_classCallCheck(this,i),this.vm=e,this.key=t,this.cb=n,(Dep.target=this).vm[this.key],Dep.target=null}return _createClass(i,[{key:"update",value:function(){this.cb.call(this.vm,this.vm[this.key])}}]),i}(),Compile=function(){function n(e,t){_classCallCheck(this,n),this.$el=document.querySelector(e),this.$vm=t,this.$el&&(this.$fragment=this.node2Fragment(this.$el),this.compile(this.$fragment),this.$el.appendChild(this.$fragment))}return _createClass(n,[{key:"node2Fragment",value:function(e){for(var t,n=document.createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}},{key:"compile",value:function(e){var r=this,t=e.childNodes;Array.from(t).forEach(function(a){var e;r.isElement(a)?(e=a.attributes,Array.from(e).forEach(function(e){var t,n,i=e.name,o=e.value;r.isDirective(i)&&(t=i.substring(2),r[t]&&r[t](a,r.$vm,o)),r.isEvent(i)&&(n=i.substring(1),r.eventHandle(a,r.$vm,o,n))})):r.isInterpolation(a)&&r.compileText(a),a.childNodes&&0<a.childNodes.length&&r.compile(a)})}},{key:"compileText",value:function(e){this.update(e,this.$vm,RegExp.$1,"text")}},{key:"update",value:function(t,e,n,i){var o=this[i+"Updater"];o&&o(t,e[n]),new Watcher(e,n,function(e){o&&o(t,e)})}},{key:"html",value:function(e,t,n){this.update(e,t,n,"html")}},{key:"htmlUpdater",value:function(e,t){e.innerHTML=t}},{key:"text",value:function(e,t,n){this.update(e,t,n,"text")}},{key:"textUpdater",value:function(e,t){e.textContent=t}},{key:"model",value:function(e,t,n){this.update(e,t,n,"model"),e.addEventListener("input",function(e){t[n]=e.target.value})}},{key:"modelUpdater",value:function(e,t){e.value=t}},{key:"eventHandle",value:function(e,t,n,i){var o=t.$options.methods&&t.$options.methods[n];i&&o&&e.addEventListener(i,o.bind(t))}},{key:"isElement",value:function(e){return 1===e.nodeType}},{key:"isInterpolation",value:function(e){return 3===e.nodeType&&/\{\{(.*)\}\}/.test(e.textContent)}},{key:"isDirective",value:function(e){return 0===e.indexOf("l-")}},{key:"isEvent",value:function(e){return 0===e.indexOf("@")}}]),n}();